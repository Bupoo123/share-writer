:root{
  --bg:#f7f8fa; --card:#fff; --text:#222; --muted:#666; --accent:#3b82f6;
  --code:#0f172a; --code-bg:#f1f5f9;
  --serif:"Noto Serif SC","Source Serif 4",serif;
  --sans:"Inter","Noto Sans SC","Microsoft YaHei",system-ui,-apple-system,sans-serif;
  --font-default:"Inter","Noto Sans SC","Microsoft YaHei",system-ui,-apple-system,sans-serif;
  --font-microsoft-yahei:"Microsoft YaHei","微软雅黑",sans-serif;
  --font-simsun:"SimSun","宋体",serif;
  --font-kaiti:"KaiTi","楷体",serif;
  --font-heiti:"SimHei","黑体",sans-serif;
  --font-fangsong:"FangSong","仿宋",serif;
}
*{box-sizing:border-box}
body{background:var(--bg);margin:0;font-family:var(--sans);color:var(--text)}
header{
  position:sticky;top:0;z-index:9;background:rgba(255,255,255,.85);
  backdrop-filter:saturate(180%) blur(10px);border-bottom:1px solid #e5e7eb
}
.bar{max-width:1200px;margin:0 auto;padding:10px 16px;display:flex;gap:8px;flex-wrap:nowrap;align-items:center;overflow-x:auto}
.title{font-weight:700;margin-right:auto;display:flex;align-items:center;gap:12px}
.logo{width:96px;height:96px;object-fit:contain}
.title-text{
  font-size: 24px;
  font-weight: 700;
  background: linear-gradient(135deg, #3b82f6, #1d4ed8);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
  letter-spacing: -0.5px;
  line-height: 1.2;
}
select,input[type="text"]{padding:8px 10px;border:1px solid #e5e7eb;border-radius:10px;background:#fff}
button{
  padding:10px 14px;border:0;border-radius:12px;background:var(--accent);color:#fff;font-weight:600;cursor:pointer;
  box-shadow:0 4px 14px rgba(59,130,246,.15)
}
button.secondary{background:#1118270d;color:#111827;border:1px solid #e5e7eb}
button:disabled{opacity:.5;cursor:not-allowed}
.wrap{max-width:1200px;margin:18px auto;padding:0 16px;display:flex;flex-direction:column;gap:16px}
.card{background:var(--card);border:1px solid #e5e7eb;border-radius:16px;box-shadow:0 10px 20px rgba(0,0,0,.03)}
.card h3{margin:0;padding:14px 16px;border-bottom:1px solid #f1f5f9}
.card .body{padding:14px 16px}
textarea{
  width:100%;min-height:420px;border:1px dashed #d1d5db;border-radius:12px;padding:12px;resize:vertical;
  font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;line-height:1.6;background:#fafafa
}
.meta{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-top:10px}
.muted{color:var(--muted);font-size:12px}
/* 右侧预览排版 */
.doc{
  --doc-width:840px; --doc-padding:48px; --doc-font:var(--sans);
  max-width:var(--doc-width); margin:24px auto; padding:var(--doc-padding);
  border-radius:18px; border:1px solid #eef2f7; background:#fff;
}
.doc.serif{--doc-font:var(--serif)}
.doc.narrow{--doc-width:720px}
.doc.wide{--doc-width:980px}
.doc *{scroll-margin-top:90px}
.doc{font-family:var(--doc-font);line-height:1.75}
.doc h1,.doc h2,.doc h3{line-height:1.3}
.doc h1{font-size:32px;margin:0 0 8px}
.doc h2{font-size:24px;margin:24px 0 8px;border-left:4px solid var(--accent);padding-left:10px}
.doc h3{font-size:18px;margin:18px 0 6px}
.doc p{margin:.5em 0}
.doc ul,.doc ol{padding-left:1.3em;margin:.5em 0}
.doc blockquote{margin:12px 0;padding:10px 14px;border-left:4px solid #e5e7eb;background:#fafafa;border-radius:8px}
.doc code{font-family:ui-monospace,Menlo,Consolas,monospace;background:var(--code-bg);color:var(--code);padding:2px 6px;border-radius:6px}
.doc pre{background:var(--code-bg);padding:14px;border-radius:12px;overflow:auto}
.toc{background:#fbfdff;border:1px solid #e5f0ff;padding:12px 14px;border-radius:12px;margin:12px 0}
.badge{display:inline-flex;gap:6px;align-items:center;font-size:12px;color:#475569;background:#f1f5f9;padding:6px 8px;border-radius:999px}
.cover{border-bottom:1px dashed #e5e7eb;margin-bottom:16px;padding-bottom:12px}
.cover h1{margin-bottom:0}
.cover .sub{color:#64748b}
.footer{margin-top:28px;padding-top:10px;border-top:1px dashed #e5e7eb;color:#6b7280;font-size:12px}
/* 设置行样式 */
.settings-row{display:flex;gap:12px;align-items:center;flex-wrap:wrap;margin-bottom:12px}
.settings-row:last-child{margin-bottom:0}
.settings-row label{margin-right:4px;white-space:nowrap}
/* 字体样式 */
.doc.font-default{font-family:var(--font-default)}
.doc.font-microsoft-yahei{font-family:var(--font-microsoft-yahei)}
.doc.font-simsun{font-family:var(--font-simsun)}
.doc.font-kaiti{font-family:var(--font-kaiti)}
.doc.font-heiti{font-family:var(--font-heiti)}
.doc.font-fangsong{font-family:var(--font-fangsong)}
/* 移动端和微信浏览器优化 */
@media screen and (max-width: 768px) {
  .wrap { padding: 0 12px; }
  .card { margin-bottom: 12px; }
  .card .body { padding: 12px; }
  .settings-row { flex-direction: column; align-items: flex-start; gap: 8px; }
  .settings-row label { margin-bottom: 4px; }
  textarea { min-height: 300px; font-size: 14px; }
  .doc { padding: 20px; margin: 16px auto; }
  .doc h1 { font-size: 28px; }
  .doc h2 { font-size: 22px; }
  .doc h3 { font-size: 18px; }
  .bar { padding: 8px 12px; flex-wrap: wrap; }
  .bar button { font-size: 12px; padding: 8px 10px; }
  .title-text { font-size: 20px; }
  .logo { width: 64px; height: 64px; }
}

@media screen and (max-width: 480px) {
  .wrap { padding: 0 8px; }
  .card .body { padding: 8px; }
  .doc { padding: 16px; margin: 12px auto; }
  .doc h1 { font-size: 24px; }
  .doc h2 { font-size: 20px; }
  .doc h3 { font-size: 16px; }
  .bar { padding: 6px 8px; }
  .bar button { font-size: 11px; padding: 6px 8px; }
  .title-text { font-size: 18px; }
  .logo { width: 48px; height: 48px; }
  .meta { grid-template-columns: 1fr; }
}

/* 微信浏览器特殊优化 */
@media screen and (-webkit-min-device-pixel-ratio: 2) {
  .doc { 
    -webkit-text-size-adjust: 100%;
    -webkit-tap-highlight-color: transparent;
  }
  .doc h1, .doc h2, .doc h3 {
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }
}

/* 打印 / 导出 Word 友好 */
@media print{
  header,.card{display:none !important}
  body{background:#fff}
  .doc{border:0;box-shadow:none;margin:0;padding:24px;max-width:auto}
}
